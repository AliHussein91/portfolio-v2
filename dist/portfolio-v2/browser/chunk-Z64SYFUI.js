import{a as m}from"./chunk-2U6NMNKK.js";import{c as R,e as T,j as g,v as V}from"./chunk-WDQRD4KS.js";import{j as N,o as A,r as q}from"./chunk-G7EGHA34.js";import{La as O,P as I,Pa as w,Qa as L,Ra as n,Sa as r,Ta as y,Ua as k,V as c,X as s,Xa as U,Ya as D,ab as a,bb as f,c as _,ea as S,fa as v,ib as p,kb as E,mb as F,s as x,ya as l}from"./chunk-EK42WQS7.js";var d=class o{uploadMediaURL=q.upload;http=c(A);postImage(t){if(t.size>4*1024*1024)throw new Error("Image size must be less than 4MB");if(!["image/jpeg","image/jpg","image/png","image/webp"].includes(t.type))throw new Error("Invalid image type. Only jpeg, jpg, png, webp are allowed");let e=new FormData;return e.append("image",t),this.http.post(this.uploadMediaURL.postUpload,e)}getImages(){return this.http.get(this.uploadMediaURL.getUploads)}markImageInUse(t){return this.http.put(this.uploadMediaURL.markInUse(t),{})}markImageNotInUse(t){return this.http.put(this.uploadMediaURL.markNotInUse(t),{})}static \u0275fac=function(e){return new(e||o)};static \u0275prov=I({token:o,factory:o.\u0275fac,providedIn:"root"})};var P=class o{projects=[];isLoading=!1;newProjectImage="";projectsService=c(m);uploadMediaService=c(d);updateProject(t,e){this.isLoading=!0,this.projectsService.updateProject(t,e).subscribe({next:i=>{this.projects=this.projects.map(j=>j._id===t?i:j)},error:i=>{console.log(i)},complete:()=>{this.isLoading=!1}})}uploadImage(t){this.isLoading=!0,this.uploadMediaService.postImage(t).subscribe({next:e=>{console.log(e),this.newProjectImage=e},error:e=>{console.log(e)},complete:()=>{this.isLoading=!1}})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=s({type:o,selectors:[["app-projects-management"]],standalone:!0,features:[p],decls:2,vars:0,consts:[[1,"projects-management"]],template:function(e,i){e&1&&(n(0,"section",0),y(1,"router-outlet"),r())},dependencies:[R],styles:[".project-management[_ngcontent-%COMP%]{width:100%}"]})};var B=(o,t)=>t._id;function J(o,t){if(o&1){let e=k();n(0,"tr")(1,"td"),a(2),r(),n(3,"td"),a(4),E(5,"date"),r(),n(6,"td"),a(7),r(),n(8,"td")(9,"button",2),a(10," Edit "),r(),n(11,"button",3),U("click",function(){let j=S(e).$implicit,z=D();return v(z.deleteProject(j._id))}),a(12," Delete "),r()()()}if(o&2){let e=t.$implicit;l(2),f(e.name),l(2),f(F(5,4,e.createdAt,"dd MMM YYY")),l(3),f(e.status?"Active":"Inactive"),l(2),O("routerLink","/admin/projects/update/"+e._id)}}var h=class o{projects=[];isLoading=!1;newProjectImage="";projectsService=c(m);uploadMediaService=c(d);ngOnInit(){this.showProjects()}showProjects(){return _(this,null,function*(){if(!localStorage.getItem("projects")){this.getProjects();return}let t=yield JSON.parse(localStorage.getItem("projects"));this.projects=t})}getProjects(){this.isLoading=!0,this.projectsService.getProjects().subscribe({next:t=>{this.projects=t,localStorage.setItem("projects",JSON.stringify(t))},error:t=>{console.log(t)},complete:()=>{this.isLoading=!1}})}getProject(t){this.isLoading=!0,this.projectsService.getProject(t).subscribe({next:e=>{console.log(e)},error:e=>{console.log(e)},complete:()=>{this.isLoading=!1}})}deleteProject(t){this.isLoading=!0,this.projectsService.deleteProject(t).subscribe({next:()=>{this.projects=this.projects.filter(e=>e._id!==t),localStorage.setItem("projects",JSON.stringify(this.projects))},error:e=>{console.log(e)},complete:()=>{this.isLoading=!1}})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=s({type:o,selectors:[["app-projects-list"]],standalone:!0,features:[p],decls:16,vars:0,consts:[[1,"projects-table"],["routerLink","/admin/projects/add",1,"add-project"],[1,"edit-project",3,"routerLink"],[1,"delete-project",3,"click"]],template:function(e,i){e&1&&(n(0,"table",0)(1,"thead")(2,"tr")(3,"th"),a(4,"Project"),r(),n(5,"th"),a(6,"Date Added"),r(),n(7,"th"),a(8,"Status"),r(),n(9,"th"),a(10,"Actions"),r()()(),n(11,"tbody"),w(12,J,13,7,"tr",null,B),r()(),n(14,"button",1),a(15,"Add Projct"),r()),e&2&&(l(12),L(i.projects))},dependencies:[T,N],styles:[".projects-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.projects-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .projects-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #ddd;padding:8px}.projects-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f2f2f2;text-align:center}.projects-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f9f9f9}.projects-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#ddd}.edit-project[_ngcontent-%COMP%], .delete-project[_ngcontent-%COMP%], .add-project[_ngcontent-%COMP%]{padding:.5rem 1rem;cursor:pointer}.edit-project[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff;border:none}.delete-project[_ngcontent-%COMP%]{background-color:#f44336;color:#fff;border:none}.add-project[_ngcontent-%COMP%]{background-color:#008cba;color:#fff;border:none}@media screen and (max-width: 600px){.projects-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{display:none}.projects-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:block;margin-bottom:10px}.projects-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{display:block;text-align:right;border:none;position:relative;padding-left:50%}.projects-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:before{content:attr(data-label);position:absolute;left:0;width:50%;padding-left:10px;font-weight:700;text-align:left}.edit-project[_ngcontent-%COMP%], .delete-project[_ngcontent-%COMP%], .add-project[_ngcontent-%COMP%]{width:100%;box-sizing:border-box}}"]})};var b=class o{projects=[];isLoading=!1;newProjectImage="";projectsService=c(m);uploadMediaService=c(d);fb=c(V);form;constructor(){this.form=this.fb.nonNullable.group({name:["",g.required],description:["",g.required],nameAr:["",g.required],descritptionAr:["",g.required],skills:["",g.required]})}addProjectWithImage(t,e){this.isLoading=!0,this.uploadMediaService.postImage(t).pipe(x(i=>(e.image=i.fileUrl,this.projectsService.postProject(e)))).subscribe({next:i=>{this.projects.push(i)},error:i=>{console.log(i)},complete:()=>{this.isLoading=!1}})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=s({type:o,selectors:[["app-add-project"]],standalone:!0,features:[p],decls:2,vars:0,template:function(e,i){e&1&&(n(0,"p"),a(1,"add-project works!"),r())}})};var C=class o{static \u0275fac=function(e){return new(e||o)};static \u0275cmp=s({type:o,selectors:[["app-update-project"]],standalone:!0,features:[p],decls:2,vars:0,template:function(e,i){e&1&&(n(0,"p"),a(1,"update-project works!"),r())}})};var ve=[{path:"",component:P,children:[{path:"",component:h},{path:"add",component:b},{path:"update/:id",component:C}]},{path:"**",redirectTo:"",pathMatch:"full"}];export{ve as projectsManagementRoutes};
